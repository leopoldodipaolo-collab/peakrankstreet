<div class="onboarding-card card shadow-lg border-0 rounded-3 overflow-hidden">
    <div class="card-header bg-gradient-primary text-white py-3">
        <div class="d-flex align-items-center">
            <i class="bi bi-flag-fill me-2 fs-4"></i>
            <h4 class="card-title mb-0">Benvenuto, Nobile Viandante!</h4>
        </div>
    </div>
    <div class="card-body p-4">
        <p class="text-muted mb-4">Inizia la tua scalata verso la gloria. Completa questi primi passi per aumentare il tuo Prestigio e farti conoscere nella community.</p>

        <div class="onboarding-steps">
            <!-- Passo 1: Profilo -->
            <div class="step-item d-flex align-items-center p-3 rounded-3 mb-3 {% if onboarding_status.profile_complete %}completed{% else %}pending{% endif %}">
                <div class="step-icon d-flex align-items-center justify-content-center me-3">
                    {% if onboarding_status.profile_complete %}
                        <i class="bi bi-check-circle-fill text-success fs-5"></i>
                    {% else %}
                        <i class="bi bi-person-bounding-box text-primary fs-5"></i>
                    {% endif %}
                </div>
                <div class="step-content flex-grow-1">
                    <h6 class="mb-1">
                        {% if onboarding_status.profile_complete %}
                            <strong>Crea il tuo Stemma</strong>
                        {% else %}
                            Crea il tuo Stemma
                        {% endif %}
                    </h6>
                    <p class="mb-0 text-muted small">
                        {% if onboarding_status.profile_complete %}
                            <span class="text-success">Completato</span>
                        {% else %}
                            Completa il profilo
                        {% endif %}
                    </p>
                </div>
                {% if not onboarding_status.profile_complete %}
                    <a href="{{ url_for('main.edit_profile') }}" class="btn btn-primary btn-sm rounded-pill px-3">Vai</a>
                {% endif %}
            </div>

            <!-- Passo 2: Segui Utenti -->
            <div class="step-item d-flex align-items-center p-3 rounded-3 mb-3 {% if onboarding_status.followed_users %}completed{% else %}pending{% endif %}">
                <div class="step-icon d-flex align-items-center justify-content-center me-3">
                    {% if onboarding_status.followed_users %}
                        <i class="bi bi-check-circle-fill text-success fs-5"></i>
                    {% else %}
                        <i class="bi bi-people text-primary fs-5"></i>
                    {% endif %}
                </div>
                <div class="step-content flex-grow-1">
                    <h6 class="mb-1">
                        {% if onboarding_status.followed_users %}
                            <strong>Giura Fedeltà</strong>
                        {% else %}
                            Giura Fedeltà
                        {% endif %}
                    </h6>
                    <p class="mb-0 text-muted small">
                        {% if onboarding_status.followed_users %}
                            <span class="text-success">Completato</span>
                        {% else %}
                            Segui 3 utenti
                        {% endif %}
                    </p>
                </div>
                {% if not onboarding_status.followed_users %}
                    <a href="{{ url_for('main.explore') }}" class="btn btn-primary btn-sm rounded-pill px-3">Esplora</a>
                {% endif %}
            </div>
            
            <!-- Passo 3: Iscriviti a un Gruppo -->
            <div class="step-item d-flex align-items-center p-3 rounded-3 mb-3 {% if onboarding_status.joined_group %}completed{% else %}pending{% endif %}">
                <div class="step-icon d-flex align-items-center justify-content-center me-3">
                    {% if onboarding_status.joined_group %}
                        <i class="bi bi-check-circle-fill text-success fs-5"></i>
                    {% else %}
                        <i class="bi bi-shield-shaded text-primary fs-5"></i>
                    {% endif %}
                </div>
                <div class="step-content flex-grow-1">
                    <h6 class="mb-1">
                        {% if onboarding_status.joined_group %}
                            <strong>Unisciti a una Gilda</strong>
                        {% else %}
                            Unisciti a una Gilda
                        {% endif %}
                    </h6>
                    <p class="mb-0 text-muted small">
                        {% if onboarding_status.joined_group %}
                            <span class="text-success">Completato</span>
                        {% else %}
                            Iscriviti a un gruppo
                        {% endif %}
                    </p>
                </div>
                {% if not onboarding_status.joined_group %}
                    <a href="{{ url_for('main.list_groups') }}" class="btn btn-primary btn-sm rounded-pill px-3">Cerca</a>
                {% endif %}
            </div>

            <!-- Passo 4: Primo Post -->
            <div class="step-item d-flex align-items-center p-3 rounded-3 {% if onboarding_status.first_post %}completed{% else %}pending{% endif %}">
                <div class="step-icon d-flex align-items-center justify-content-center me-3">
                    {% if onboarding_status.first_post %}
                        <i class="bi bi-check-circle-fill text-success fs-5"></i>
                    {% else %}
                        <i class="bi bi-pencil-square text-primary fs-5"></i>
                    {% endif %}
                </div>
                <div class="step-content flex-grow-1">
                    <h6 class="mb-1">
                        {% if onboarding_status.first_post %}
                            <strong>Lascia il Segno</strong>
                        {% else %}
                            Lascia il Segno
                        {% endif %}
                    </h6>
                    <p class="mb-0 text-muted small">
                        {% if onboarding_status.first_post %}
                            <span class="text-success">Completato</span>
                        {% else %}
                            Pubblica il tuo primo post
                        {% endif %}
                    </p>
                </div>
                {% if not onboarding_status.first_post %}
                    <a href="{{ url_for('main.create_post') }}" class="btn btn-primary btn-sm rounded-pill px-3">Scrivi</a>
                {% endif %}
            </div>
        </div>
        
        <!-- Progress Bar -->
        <div class="progress-container mt-4 pt-3 border-top">
            <div class="d-flex justify-content-between mb-2">
                <span class="small text-muted">Progresso onboarding</span>
                <span class="small text-muted">
                    {% set completed_count = [onboarding_status.profile_complete, onboarding_status.followed_users, onboarding_status.joined_group, onboarding_status.first_post]|select|list|length %}
                    {{ completed_count }}/4 completati
                </span>
            </div>
            <div class="progress" style="height: 6px;">
                <div class="progress-bar bg-primary" role="progressbar" 
                     style="width: {{ completed_count * 25 }}%;" 
                     aria-valuenow="{{ completed_count * 25 }}" 
                     aria-valuemin="0" 
                     aria-valuemax="100">
                </div>
            </div>
        </div>
    </div>
</div>

<style>
.onboarding-card {
    border: none;
    transition: transform 0.2s ease, box-shadow 0.2s ease;
}

.onboarding-card:hover {
    transform: translateY(-2px);
}

.bg-gradient-primary {
    background: linear-gradient(135deg, #4e54c8 0%, #8f94fb 100%);
}

.step-item {
    transition: all 0.2s ease;
    border: 1px solid #e9ecef;
}

.step-item:hover {
    background-color: #f8f9fa;
    border-color: #dee2e6;
}

.step-item.completed {
    background-color: rgba(40, 167, 69, 0.05);
    border-color: rgba(40, 167, 69, 0.2);
}

.step-icon {
    width: 40px;
    height: 40px;
    border-radius: 50%;
    background-color: #f8f9fa;
}

.step-item.completed .step-icon {
    background-color: rgba(40, 167, 69, 0.1);
}

.step-item.pending .step-icon {
    background-color: rgba(13, 110, 253, 0.1);
}

.progress-container {
    background-color: #f8f9fa;
    border-radius: 8px;
    padding: 15px;
}
</style>